"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
var Rx_1 = require("rxjs/Rx");
var Config_1 = require("../Config");
require("rxjs/add/operator/filter");
var post_1 = require("./post");
var comment_1 = require("./comment");
var BlogService = (function () {
    function BlogService(http) {
        this.http = http;
        this.title = "";
        this.body = "";
        this.slug = "";
    }
    //Pulls the Posts from the Blog API and returns the array of Posts to the post component
    BlogService.prototype.posts = function () {
        var headers = new http_1.Headers();
        headers.append("Ocp-Apim-Subscription-Key", Config_1.Config.apiKey);
        var result = this.http.get(Config_1.Config.apiUrl + "Posts", { headers: headers })
            .map(function (res) { return res.json(); })
            .map(function (data) {
            var posts = new Array();
            data.forEach(function (post) {
                posts.push(new post_1.Post(post.title, post.body, post.slug, post.isStatic, post.isFeatured, post.dateCreated, post.datePublished, post.status, post.tags));
            });
            return posts;
        }).catch(this.handleErrors);
        return result;
    };
    //Reports the error for any of the data being pulled or pushed from/to the Blog API
    BlogService.prototype.handleErrors = function (error, caught) {
        console.log(JSON.stringify(error));
        return Rx_1.Observable.throw(error);
    };
    //Pulls a Post by slug to open up and read
    //Needs to be fixed like how comments are chosen by the delete function
    BlogService.prototype.getPostBySlug = function (slug) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        console.log(Config_1.Config.postUrl + slug);
        return this.http.get(Config_1.Config.postUrl + slug, { headers: headers })
            .map(function (res) { return res.json(); })
            .map(function (data) {
            var post = new post_1.Post(data.title, data.body, data.slug, data.isStatic, data.isFeatured, data.dateCreated, data.datePublished, data.status, data.tags);
            return post;
        }).catch(this.handleErrors);
    };
    //Posts a Comment to the Blog API to be posted.
    BlogService.prototype.postComment = function (comment, slug) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        return this.http.post(Config_1.Config.createCommentUrl + slug, JSON.stringify({
            "Email": comment.email,
            "Message": comment.message,
            "Name": comment.name
        }), { headers: headers })
            .map(function (res) { return res.json(); })
            .catch(this.handleErrors);
    };
    //Gets all comments for a blog post and stores them in a Comment array 
    BlogService.prototype.getComments = function (slug) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        var result = this.http.get(Config_1.Config.getAllCommentsUrl + slug, { headers: headers })
            .map(function (res) { return res.json(); })
            .map(function (data) {
            var comments = new Array();
            data.forEach(function (comment) {
                comments.push(new comment_1.Comment(comment.id, comment.email, comment.message, comment.user, comment.dateCreated));
            });
            return comments;
        }).catch(this.handleErrors);
        return result;
    };
    //Gets an id of type GUID and deletes it from the Blog API
    BlogService.prototype.deleteComment = function (id) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        return this.http.delete(Config_1.Config.deleteCommentUrl + id)
            .map(function (res) { return res.json(); })
            .catch(this.handleErrors);
    };
    return BlogService;
}());
BlogService = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [http_1.Http])
], BlogService);
exports.BlogService = BlogService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmxvZy5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYmxvZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTBDO0FBQzFDLHNDQUF1RDtBQUN2RCw4QkFBcUM7QUFDckMsb0NBQWtDO0FBQ2xDLG9DQUFrQztBQUNsQywrQkFBNkI7QUFDN0IscUNBQW1DO0FBSW5DLElBQWEsV0FBVztJQU1wQixxQkFBb0IsSUFBVTtRQUFWLFNBQUksR0FBSixJQUFJLENBQU07UUFKOUIsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLFNBQUksR0FBRyxFQUFFLENBQUM7UUFDVixTQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXVCLENBQUM7SUFFbEMsd0ZBQXdGO0lBQ3hGLDJCQUFLLEdBQUw7UUFDSSxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxNQUFNLENBQUMsMkJBQTJCLEVBQUUsZUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRTNELElBQUksTUFBTSxHQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLGVBQU0sQ0FBQyxNQUFNLEdBQUcsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBQyxDQUFDO2FBQ3BFLEdBQUcsQ0FBQyxVQUFBLEdBQUcsSUFBRSxPQUFBLEdBQUcsQ0FBQyxJQUFJLEVBQUUsRUFBVixDQUFVLENBQUM7YUFDcEIsR0FBRyxDQUFDLFVBQUEsSUFBSTtZQUNMLElBQUksS0FBSyxHQUFHLElBQUksS0FBSyxFQUFRLENBQUM7WUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFDLElBQUk7Z0JBQ2QsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLFdBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxVQUFVLEVB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QUFDLEFBbkdELElBbUdDO0FBbkdZLFdBQVc7SUFEdkIsaUJBQVUsRUFBRTtxQ0FPaUIsV0FBSTtHQU5yQixXQUFXLENBbUd2QjtBQW5HWSxrQ0FBVyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiXHJcbmltcG9ydCB7IEh0dHAsIEhlYWRlcnMsIFJlc3BvbnNlIH0gZnJvbSBcIkBhbmd1bGFyL2h0dHBcIlxyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anMvUnhcIjtcclxuaW1wb3J0IHsgQ29uZmlnIH0gZnJvbSBcIi4uL0NvbmZpZ1wiXHJcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvZmlsdGVyJztcclxuaW1wb3J0IHsgUG9zdCB9IGZyb20gXCIuL3Bvc3RcIlxyXG5pbXBvcnQgeyBDb21tZW50IH0gZnJvbSBcIi4vY29tbWVudFwiXHJcblxyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQmxvZ1NlcnZpY2Uge1xyXG4gICAgXHJcbiAgICB0aXRsZSA9IFwiXCI7XHJcbiAgICBib2R5ID0gXCJcIjtcclxuICAgIHNsdWcgPSBcIlwiO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cCkge31cclxuXHJcbiAgICAvL1B1bGxzIHRoZSBQb3N0cyBmcm9tIHRoZSBCbG9nIEFQSSBhbmQgcmV0dXJucyB0aGUgYXJyYXkgb2YgUG9zdHMgdG8gdGhlIHBvc3QgY29tcG9uZW50XHJcbiAgICBwb3N0cygpIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XHJcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5XCIsIENvbmZpZy5hcGlLZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZXN1bHQgPSAgdGhpcy5odHRwLmdldChDb25maWcuYXBpVXJsICsgXCJQb3N0c1wiLCB7IGhlYWRlcnM6IGhlYWRlcnN9KVxyXG4gICAgICAgICAgICAubWFwKHJlcz0+cmVzLmpzb24oKSlcclxuICAgICAgICAgICAgLm1hcChkYXRhPT57XHJcbiAgICAgICAgICAgICAgICBsZXQgcG9zdHMgPSBuZXcgQXJyYXk8UG9zdD4oKTtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgocG9zdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc3RzLnB1c2gobmV3IFBvc3QocG9zdC50aXRsZSwgcG9zdC5ib2R5LCBwb3N0LnNsdWcsIHBvc3QuaXNTdGF0aWMsIHBvc3QuaXNGZWF0dXJlZCxcclxuICAgICAgICAgICAgICAgICAgICBwb3N0LmRhdGVDcmVhdGVkLCBwb3N0LmRhdGVQdWJsaXNoZWQsIHBvc3Quc3RhdHVzLCBwb3N0LnRhZ3MpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zdHM7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKHRoaXMuaGFuZGxlRXJyb3JzKVxyXG4gICAgICAgICAgICA7XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy9SZXBvcnRzIHRoZSBlcnJvciBmb3IgYW55IG9mIHRoZSBkYXRhIGJlaW5nIHB1bGxlZCBvciBwdXNoZWQgZnJvbS90byB0aGUgQmxvZyBBUElcclxuICAgIGhhbmRsZUVycm9ycyhlcnJvciwgY2F1Z2h0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZXJyb3IpKTtcclxuICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdyhlcnJvcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy9QdWxscyBhIFBvc3QgYnkgc2x1ZyB0byBvcGVuIHVwIGFuZCByZWFkXHJcbiAgICAvL05lZWRzIHRvIGJlIGZpeGVkIGxpa2UgaG93IGNvbW1lbnRzIGFyZSBjaG9zZW4gYnkgdGhlIGRlbGV0ZSBmdW5jdGlvblxyXG4gICAgZ2V0UG9zdEJ5U2x1ZyhzbHVnOiBzdHJpbmcpIHtcclxuXHQgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG5cdCAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKENvbmZpZy5wb3N0VXJsICsgc2x1Zyk7XHJcblxyXG5cdCAgICByZXR1cm4gdGhpcy5odHRwLmdldChDb25maWcucG9zdFVybCArIHNsdWcsIHsgaGVhZGVyczogaGVhZGVyc30pXHJcblx0ICAgICAgICAubWFwKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgICAgICAgICAubWFwKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHBvc3QgPSBuZXcgUG9zdChkYXRhLnRpdGxlLCBkYXRhLmJvZHksIGRhdGEuc2x1ZywgZGF0YS5pc1N0YXRpYywgZGF0YS5pc0ZlYXR1cmVkLCBcclxuICAgICAgICAgICAgICAgIGRhdGEuZGF0ZUNyZWF0ZWQsIGRhdGEuZGF0ZVB1Ymxpc2hlZCwgZGF0YS5zdGF0dXMsIGRhdGEudGFncyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zdDtcclxuICAgICAgICAgICAgfSkuY2F0Y2godGhpcy5oYW5kbGVFcnJvcnMpO1xyXG5cclxuXHR9XHJcblxyXG4gICAgLy9Qb3N0cyBhIENvbW1lbnQgdG8gdGhlIEJsb2cgQVBJIHRvIGJlIHBvc3RlZC5cclxuICAgIHBvc3RDb21tZW50KGNvbW1lbnQ6IENvbW1lbnQsIHNsdWc6IHN0cmluZyl7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG5cdCAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdChDb25maWcuY3JlYXRlQ29tbWVudFVybCArIHNsdWcsXHJcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgXCJFbWFpbFwiOiBjb21tZW50LmVtYWlsLFxyXG4gICAgICAgICAgICBcIk1lc3NhZ2VcIjogY29tbWVudC5tZXNzYWdlLFxyXG4gICAgICAgICAgICBcIk5hbWVcIjogY29tbWVudC5uYW1lXHJcbiAgICAgICAgfSksIFxyXG4gICAgICAgICAgICB7IGhlYWRlcnM6IGhlYWRlcnN9KVxyXG4gICAgICAgICAgICAubWFwKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgICAgICAgICAuY2F0Y2godGhpcy5oYW5kbGVFcnJvcnMpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvL0dldHMgYWxsIGNvbW1lbnRzIGZvciBhIGJsb2cgcG9zdCBhbmQgc3RvcmVzIHRoZW0gaW4gYSBDb21tZW50IGFycmF5IFxyXG4gICAgZ2V0Q29tbWVudHMoc2x1Zzogc3RyaW5nKXtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XHJcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZXN1bHQgPSAgdGhpcy5odHRwLmdldChDb25maWcuZ2V0QWxsQ29tbWVudHNVcmwgKyBzbHVnLCB7IGhlYWRlcnM6IGhlYWRlcnN9KVxyXG4gICAgICAgICAgICAubWFwKHJlcz0+cmVzLmpzb24oKSlcclxuICAgICAgICAgICAgLm1hcChkYXRhPT57XHJcbiAgICAgICAgICAgICAgICBsZXQgY29tbWVudHMgPSBuZXcgQXJyYXk8Q29tbWVudD4oKTtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoY29tbWVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzLnB1c2gobmV3IENvbW1lbnQoY29tbWVudC5pZCwgY29tbWVudC5lbWFpbCwgY29tbWVudC5tZXNzYWdlLCBjb21tZW50LnVzZXIsIGNvbW1lbnQuZGF0ZUNyZWF0ZWQpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tbWVudHM7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKHRoaXMuaGFuZGxlRXJyb3JzKVxyXG4gICAgICAgICAgICA7XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vR2V0cyBhbiBpZCBvZiB0eXBlIEdVSUQgYW5kIGRlbGV0ZXMgaXQgZnJvbSB0aGUgQmxvZyBBUElcclxuICAgIGRlbGV0ZUNvbW1lbnQoaWQ6IHN0cmluZyl7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG5cdCAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlKENvbmZpZy5kZWxldGVDb21tZW50VXJsICsgaWQpXHJcbiAgICAgICAgICAgIC5tYXAocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRsZUVycm9ycyk7XHJcbiAgICB9XHJcbiAgICBcclxuXHJcbn0iXX0=